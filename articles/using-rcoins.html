<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tracing continuous streets using rcoins • rcoins</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tracing continuous streets using rcoins">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rcoins</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using-rcoins.html">Tracing continuous streets using rcoins</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tracing continuous streets using rcoins</h1>
            
      

      <div class="hidden name"><code>using-rcoins.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">rcoins</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>In this article we demonstrate how to trace continuous streets using
the <code><a href="../reference/stroke.html">stroke()</a></code> function. The function takes an
<code>sf</code> object of streets and returns a new <code>sf</code>
object with continuous streets.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load streets from example data</span></span>
<span><span class="va">streets</span> <span class="op">&lt;-</span> <span class="va">bucharest</span><span class="op">$</span><span class="va">streets</span></span></code></pre></div>
<div class="section level2">
<h2 id="tracing-on-the-entire-network">Tracing on the entire network<a class="anchor" aria-label="anchor" href="#tracing-on-the-entire-network"></a>
</h2>
<p>If we run the <code><a href="../reference/stroke.html">stroke()</a></code> function with the default values,
strokes will be calculated on the network as a whole.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Trace continuous streets</span></span>
<span><span class="va">continuous_streets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stroke.html">stroke</a></span><span class="op">(</span><span class="va">streets</span><span class="op">)</span></span></code></pre></div>
<p>To visualise the strokes in a more intuitive way, we map the line
weight in the plot to the length of the strokes. The thicker a line is,
the longer the stroke.</p>
<p><img src="using-rcoins_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="tracing-from-specified-streets">Tracing from specified streets<a class="anchor" aria-label="anchor" href="#tracing-from-specified-streets"></a>
</h2>
<p>To trace continuous streets from a given set of streets, we can add
the edge indices in the <code>from_edge</code> argument. We demonstrate
this by tracing all continuous streets crossing river Dâmbovița in
Bucharest. We load the river centerline from the package data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load river centerline from example data</span></span>
<span><span class="va">river_centerline</span> <span class="op">&lt;-</span> <span class="va">bucharest</span><span class="op">$</span><span class="va">river_centerline</span></span>
<span></span>
<span><span class="va">crossing_edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">st_intersects</a></span><span class="op">(</span><span class="va">streets</span>,</span>
<span>                                      <span class="va">river_centerline</span>,</span>
<span>                                      sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trace continuous streets crossing the river</span></span>
<span><span class="va">continuous_streets_crossing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stroke.html">stroke</a></span><span class="op">(</span><span class="va">streets</span>, from_edge <span class="op">=</span> <span class="va">crossing_edges</span>,</span>
<span>                                      angle_threshold <span class="op">=</span> <span class="fl">120</span><span class="op">)</span></span></code></pre></div>
<p>Note that the input argument <code>angle_threshold</code> sets the
minimum internal angle between consecutive line segments that can be
considered part of a continuous stroke.</p>
<p>We plot the street network and emphasize the continuous streets
crossing the river.</p>
<p><img src="using-rcoins_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="maintaining-the-initial-structure">Maintaining the initial structure<a class="anchor" aria-label="anchor" href="#maintaining-the-initial-structure"></a>
</h2>
<p>The <code>flow_mode</code> argument allows us to maintain the initial
structure of the streets. With <code>flow_mode = FALSE</code> (the
default), the function will split the initial streets in individual line
segments and calculate the continuous streets purely based on minimum
angle deviations. With <code>flow_mode = TRUE</code>, the function will
not break the initial line strings, but only group and connect them on
the basis of minimum angle deviations.</p>
<!-- Question: is there a situation when we want `flow_mode = TRUE` without `attribute_mode = TRUE`? If not, we may want to drop this argument, or at least not present it in the vignette. -->
</div>
<div class="section level2">
<h2 id="tracing-with-attributes">Tracing with attributes<a class="anchor" aria-label="anchor" href="#tracing-with-attributes"></a>
</h2>
<p>By enabling <code>flow_mode</code> and <code>attributes</code>
arguments, <code>stroke</code> will still group streets on the basis of
minimum-angle connectivity, but return group labels instead of the new
aggregated geometries. This is useful if we want to keep attributes such
as degree of the initial streets (“primary”, “secondary”, “tertiary”,
etc.) in the resulting continuous streets to calculate, for instance,
the relationship between street degree and street length.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Francesco Nattino, Claudiu Forgaci, Netherlands eScience Center.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
